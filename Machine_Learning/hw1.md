# Homework 1

### 姓名：满凯      学号：1500011363



# Part2 SVD的实现

```python
import numpy as np
import csv
from sympy.matrices import Matrix,GramSchmidt

# 数据的导入
A = np.loadtxt('data.csv',delimiter=',',skiprows=1)

# 利用SVD函数先生成结果，作为对比
U_ex,sigma_ex,VT_ex = np.linalg.svd(A,full_matrices=1,compute_uv=1)
print(U_ex)
print(sigma_ex)
print(VT_ex)
```

    # 输出结果如下
    [[-0.28718327  0.41978769  0.33172385  0.09491431 -0.22259948 -0.44684772
      -0.10848142  0.14322389 -0.5503365  -0.19462693]
     [-0.31959553 -0.13781121 -0.36435784  0.47557706 -0.1150013   0.00329823
      -0.57940633 -0.37669615 -0.0708049   0.15516249]
     [-0.31874178  0.03977568  0.13057767 -0.67077205 -0.15449672  0.05304929
      -0.19031345 -0.51758658  0.17453316 -0.26186933]
     [-0.33126409 -0.72583247  0.31013101  0.24245561 -0.07268268 -0.09153651
       0.28534158 -0.00578992  0.01290978 -0.33642779]
     [-0.30594714  0.04824961 -0.0110717  -0.04360642  0.93661718 -0.08854603
      -0.04704861 -0.02540472 -0.09868404 -0.06598921]
     [-0.30371475  0.18643074  0.23780996  0.1254348  -0.03439672  0.8638914
       0.01705701  0.13753723 -0.18372489 -0.01611561]
     [-0.33111103  0.25604598 -0.502754    0.08280319 -0.10443772 -0.03399757
       0.69687234 -0.25435932 -0.05263823 -0.00494054]
     [-0.34039937 -0.15248823 -0.48350844 -0.31354477 -0.1221343  -0.01113487
      -0.18799334  0.67459095  0.03907645 -0.14765733]
     [-0.30777953  0.34091195  0.23686127  0.2739801  -0.02872628 -0.14788648
      -0.02466134  0.16713222  0.77804884  0.0358536 ]
     [-0.31300394 -0.18507805  0.21130421 -0.24131033 -0.05466322 -0.10873866
       0.10390291  0.04889634 -0.09130602  0.85355661]]
    [588.72299375  20.29903256   6.74135832]
    [[-0.86646678 -0.41568645 -0.27647801]
     [ 0.42247877 -0.31548215 -0.84969565]
     [-0.26598309  0.85303915 -0.4489735 ]]

```python
# 求ATA矩阵的特征向量，得到V矩阵
ATA = np.dot(A.T,A)
vVals,vVects = np.linalg.eig(ATA)
print(vVects)
```

    # 输出结果如下
    [[-0.86646678 -0.42247877  0.26598309]
     [-0.41568645  0.31548215 -0.85303915]
     [-0.27647801  0.84969565  0.4489735 ]]

```python
# 求AV向量的模，作为对角元，得到Sigma矩阵
sigma = np.zeros(vVects.shape[1])
AvVects = np.dot(A,vVects)
for i in range(0,vVects.shape[1]):
    sigma[i] = np.linalg.norm(AvVects[:,i])
sigma_array = np.zeros((A.shape[0],A.shape[1]))
for i in range(0,sigma.shape[0]):
    sigma_array[i,i] = sigma[i]
print(sigma)
print(sigma_array)
```

    # 输出结果如下
    [588.72299375  20.29903256   6.74135832]
    [[588.72299375   0.           0.        ]
     [  0.          20.29903256   0.        ]
     [  0.           0.           6.74135832]
     [  0.           0.           0.        ]
     [  0.           0.           0.        ]
     [  0.           0.           0.        ]
     [  0.           0.           0.        ]
     [  0.           0.           0.        ]
     [  0.           0.           0.        ]
     [  0.           0.           0.        ]]

```python
# 求每个V向量对应的U向量，得到V矩阵的一部分
uTVects = np.zeros((A.shape[0],A.shape[0]))
for i in range(0,A.shape[1]):
    uTVects[i] = AvVects[:,i]/sigma[i]
uVects = uTVects.T
print(uVects)
```

    # 输出结果如下
    [[-0.28718327 -0.41978769 -0.33172385  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.31959553  0.13781121  0.36435784  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.31874178 -0.03977568 -0.13057767  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.33126409  0.72583247 -0.31013101  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.30594714 -0.04824961  0.0110717   0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.30371475 -0.18643074 -0.23780996  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.33111103 -0.25604598  0.502754    0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.34039937  0.15248823  0.48350844  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.30777953 -0.34091195 -0.23686127  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.31300394  0.18507805 -0.21130421  0.          0.          0.
       0.          0.          0.          0.        ]]

```python
print(np.dot(np.dot(uVects,sigma_array),vVects.T))
print(A)
print(np.dot(np.dot(U_ex,sigma_array),VT_ex))
```

    [[149.5  69.5  38.5]
     [162.5  77.   55.5]
     [162.7  78.5  50.8]
     [162.2  87.5  65.5]
     [156.5  74.5  49. ]
     [156.1  74.5  45.5]
     [172.   76.5  51. ]
     [173.2  81.5  59.5]
     [159.5  74.5  43.5]
     [157.7  79.   53.5]]
    [[149.5  69.5  38.5]
     [162.5  77.   55.5]
     [162.7  78.5  50.8]
     [162.2  87.5  65.5]
     [156.5  74.5  49. ]
     [156.1  74.5  45.5]
     [172.   76.5  51. ]
     [173.2  81.5  59.5]
     [159.5  74.5  43.5]
     [157.7  79.   53.5]]
    [[149.5  69.5  38.5]
     [162.5  77.   55.5]
     [162.7  78.5  50.8]
     [162.2  87.5  65.5]
     [156.5  74.5  49. ]
     [156.1  74.5  45.5]
     [172.   76.5  51. ]
     [173.2  81.5  59.5]
     [159.5  74.5  43.5]
     [157.7  79.   53.5]]

```python
# 将U向量组扩展为线性无关的向量组
for i in range(0,uVects.shape[1]-vVects.shape[0]):
    uVects[i,i+vVects.shape[0]] = 1
print(uVects)
```

    [[-0.28718327 -0.41978769 -0.33172385  1.          0.          0.
       0.          0.          0.          0.        ]
     [-0.31959553  0.13781121  0.36435784  0.          1.          0.
       0.          0.          0.          0.        ]
     [-0.31874178 -0.03977568 -0.13057767  0.          0.          1.
       0.          0.          0.          0.        ]
     [-0.33126409  0.72583247 -0.31013101  0.          0.          0.
       1.          0.          0.          0.        ]
     [-0.30594714 -0.04824961  0.0110717   0.          0.          0.
       0.          1.          0.          0.        ]
     [-0.30371475 -0.18643074 -0.23780996  0.          0.          0.
       0.          0.          1.          0.        ]
     [-0.33111103 -0.25604598  0.502754    0.          0.          0.
       0.          0.          0.          1.        ]
     [-0.34039937  0.15248823  0.48350844  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.30777953 -0.34091195 -0.23686127  0.          0.          0.
       0.          0.          0.          0.        ]
     [-0.31300394  0.18507805 -0.21130421  0.          0.          0.
       0.          0.          0.          0.        ]]

```python
# 将U向量组施密特正交化后得到一组正交基
MA = [Matrix(col) for col in uVects.T]
gram = GramSchmidt(MA)
print(gram)
```

    [Matrix([
    [-0.287183271962882],
    [-0.319595532000863],
    [ -0.31874177965296],
    [ -0.33126408897704],
    [-0.305947137102944],
    [  -0.3037147463597],
    [-0.331111032878524],
    [-0.340399366355371],
    [-0.307779529049296],
    [-0.313003936746811]]), Matrix([
    [ -0.419787691496578],
    [  0.137811207814467],
    [-0.0397756838023015],
    [  0.725832469407683],
    [-0.0482496050362399],
    [ -0.186430735961433],
    [ -0.256045977315988],
    [  0.152488234839042],
    [ -0.340911946492005],
    [  0.185078046180598]]), Matrix([
    [-0.331723849548753],
    [ 0.364357836826244],
    [-0.130577665517665],
    [-0.310131005354351],
    [0.0110717024238728],
    [-0.237809964093758],
    [ 0.502754003841472],
    [ 0.483508435880952],
    [-0.236861268748807],
    [-0.211304209548474]]), Matrix([
    [  0.631263350013223],
    [ 0.0869351424513224],
    [ -0.151550375543684],
    [  0.106684180829112],
    [ -0.104444742445579],
    [ -0.244370359626446],
    [-0.0357990060091859],
    [  0.126646959919168],
    [ -0.310072303095412],
    [-0.0822906547566384]]), Matrix([
    [1.38777878078145e-17],
    [   0.734137762719842],
    [  -0.027938987396722],
    [  -0.107591841773927],
    [ -0.0807803380334021],
    [  0.0489280320555565],
    [   -0.24878786222132],
    [  -0.323416120758306],
    [  0.0776207403565205],
    [ -0.0372173939625935]]), Matrix([
    [5.28145204273976e-19],
    [3.46944695195361e-18],
    [   0.842324360837194],
    [ -0.0956958387315094],
    [  -0.126140368864938],
    [  -0.192079757861024],
    [ -0.0681374041160793],
    [  -0.021202245188785],
    [  -0.214077512592084],
    [   -0.14116972037661]]), Matrix([
    [2.09386670263114e-18],
    [6.97831003045398e-17],
    [                   0],
    [   0.222580252502468],
    [ -0.0714127245145882],
    [   -0.01239706926459],
    [   0.193928724209403],
    [  -0.144702657260537],
    [   0.111487733697615],
    [  -0.311139993078165]]), Matrix([
    [2.27792082214935e-18],
    [5.06643685766957e-17],
    [                   0],
    [                   0],
    [   0.835974436816607],
    [  -0.167073026467308],
    [  -0.100504807061076],
    [  -0.166374202918718],
    [  -0.147041212767085],
    [  -0.223170499263635]]), Matrix([
    [-2.79881774870593e-17],
    [-1.29522159880611e-17],
    [                    0],
    [ 3.12250225675825e-17],
    [ 2.77555756156289e-17],
    [    0.640705752895869],
    [  -0.0508383368665854],
    [   0.0644637454225631],
    [   -0.410562389558919],
    [   -0.234308139876555]]), Matrix([
    [9.74427565295701e-19],
    [2.78104568034243e-17],
    [                   0],
    [ 2.4776244146125e-18],
    [1.60801206208033e-17],
    [2.77555756156289e-17],
    [   0.295109671110834],
    [  -0.309696793625725],
    [  -0.226103915456475],
    [   0.246951146101584]])]

```python
# 得到U矩阵，与SVD函数所得做对比
U = np.array(gram).T
print(U)
print(U_ex)
```

    [[-0.287183271962882 -0.419787691496578 -0.331723849548753
      0.631263350013223 1.38777878078145e-17 5.28145204273976e-19
      2.09386670263114e-18 2.27792082214935e-18 -2.79881774870593e-17
      9.74427565295701e-19]
     [-0.319595532000863 0.137811207814467 0.364357836826244
      0.0869351424513224 0.734137762719842 3.46944695195361e-18
      6.97831003045398e-17 5.06643685766957e-17 -1.29522159880611e-17
      2.78104568034243e-17]
     [-0.318741779652960 -0.0397756838023015 -0.130577665517665
      -0.151550375543684 -0.0279389873967220 0.842324360837194 0 0 0 0]
     [-0.331264088977040 0.725832469407683 -0.310131005354351
      0.106684180829112 -0.107591841773927 -0.0956958387315094
      0.222580252502468 0 3.12250225675825e-17 2.47762441461250e-18]
     [-0.305947137102944 -0.0482496050362399 0.0110717024238728
      -0.104444742445579 -0.0807803380334021 -0.126140368864938
      -0.0714127245145882 0.835974436816607 2.77555756156289e-17
      1.60801206208033e-17]
     [-0.303714746359700 -0.186430735961433 -0.237809964093758
      -0.244370359626446 0.0489280320555565 -0.192079757861024
      -0.0123970692645900 -0.167073026467308 0.640705752895869
      2.77555756156289e-17]
     [-0.331111032878524 -0.256045977315988 0.502754003841472
      -0.0357990060091859 -0.248787862221320 -0.0681374041160793
      0.193928724209403 -0.100504807061076 -0.0508383368665854
      0.295109671110834]
     [-0.340399366355371 0.152488234839042 0.483508435880952
      0.126646959919168 -0.323416120758306 -0.0212022451887850
      -0.144702657260537 -0.166374202918718 0.0644637454225631
      -0.309696793625725]
     [-0.307779529049296 -0.340911946492005 -0.236861268748807
      -0.310072303095412 0.0776207403565205 -0.214077512592084
      0.111487733697615 -0.147041212767085 -0.410562389558919
      -0.226103915456475]
     [-0.313003936746811 0.185078046180598 -0.211304209548474
      -0.0822906547566384 -0.0372173939625935 -0.141169720376610
      -0.311139993078165 -0.223170499263635 -0.234308139876555
      0.246951146101584]]
    [[-0.28718327  0.41978769  0.33172385  0.09491431 -0.22259948 -0.44684772
      -0.10848142  0.14322389 -0.5503365  -0.19462693]
     [-0.31959553 -0.13781121 -0.36435784  0.47557706 -0.1150013   0.00329823
      -0.57940633 -0.37669615 -0.0708049   0.15516249]
     [-0.31874178  0.03977568  0.13057767 -0.67077205 -0.15449672  0.05304929
      -0.19031345 -0.51758658  0.17453316 -0.26186933]
     [-0.33126409 -0.72583247  0.31013101  0.24245561 -0.07268268 -0.09153651
       0.28534158 -0.00578992  0.01290978 -0.33642779]
     [-0.30594714  0.04824961 -0.0110717  -0.04360642  0.93661718 -0.08854603
      -0.04704861 -0.02540472 -0.09868404 -0.06598921]
     [-0.30371475  0.18643074  0.23780996  0.1254348  -0.03439672  0.8638914
       0.01705701  0.13753723 -0.18372489 -0.01611561]
     [-0.33111103  0.25604598 -0.502754    0.08280319 -0.10443772 -0.03399757
       0.69687234 -0.25435932 -0.05263823 -0.00494054]
     [-0.34039937 -0.15248823 -0.48350844 -0.31354477 -0.1221343  -0.01113487
      -0.18799334  0.67459095  0.03907645 -0.14765733]
     [-0.30777953  0.34091195  0.23686127  0.2739801  -0.02872628 -0.14788648
      -0.02466134  0.16713222  0.77804884  0.0358536 ]
     [-0.31300394 -0.18507805  0.21130421 -0.24131033 -0.05466322 -0.10873866
       0.10390291  0.04889634 -0.09130602  0.85355661]]

```python
# 验证SVD分解的结果
print(np.dot(np.dot(U,sigma_array),vVects.T))
print(A)
```

    [[149.500000000000 69.5000000000000 38.5000000000000]
     [171.995474382600 81.4142840775299 57.9453228343151]
     [138.095898912230 66.9937938660066 43.8247739454709]
     [146.304927069225 79.6927327425339 59.5266010307621]
     [116.122317975972 55.0278657108987 36.1737772671175]
     [104.164719882697 49.6980487586568 30.3075798510167]
     [137.355442805450 61.6076195103664 41.5877870061777]
     [104.783197344798 49.3661238908805 36.2320232783980]
     [112.200182521507 52.6119135562083 32.0308432888027]
     [41.7843802276350 22.3466673545458 16.0911998977427]]
    [[149.5  69.5  38.5]
     [162.5  77.   55.5]
     [162.7  78.5  50.8]
     [162.2  87.5  65.5]
     [156.5  74.5  49. ]
     [156.1  74.5  45.5]
     [172.   76.5  51. ]
     [173.2  81.5  59.5]
     [159.5  74.5  43.5]
     [157.7  79.   53.5]]



## Part2 PCA的实现

```python
# 在助教提供的代码的基础上的修改

import numpy as np
import matplotlib as mpl 
import matplotlib.pyplot as plt 
from mpl_toolkits.mplot3d import Axes3D
import csv


def zeroMean(dataMat):
	meanValue = np.mean(dataMat, axis = 0)
	newData = dataMat - meanValue
	return newData,meanValue

def pca(dataMat,n):
	newData,meanValue = zeroMean(dataMat)
	covMat = np.cov(newData, rowvar = 0)
	eigVals,eigVects = np.linalg.eig(np.mat(covMat))
	eigValIndice = np.argsort(eigVals)
	n_eigValIndice = eigValIndice[-1:-(n+1):-1]
	n_eigVect = eigVects[:,n_eigValIndice]
	lowDDataMat = newData*n_eigVect
	reconDataMat = (lowDDataMat*n_eigVect.T) + meanValue
	return lowDDataMat,reconDataMat

#读取数据
p = r'/Users/mankai/Documents/满凯的资料/课程资料/机器学习基础/作业/data.csv'
with open(p,encoding = 'utf-8') as f:
    dataMat = np.loadtxt(f,delimiter = ",",skiprows = 1)

#执行PCA过程,降2维
lowDDataMat,reconDataMat = pca(dataMat,1)
print("原数据为：\n",dataMat)
print("降维之后的数据为\n",reconDataMat)

#降2维后的图表展示结果
plt.scatter(reconDataMat[:,0].tolist(),reconDataMat[:,1].tolist(), marker='o')
plt.scatter(dataMat[:,0].tolist(),dataMat[:,1].tolist(), marker='^')
plt.show()

#执行PCA过程,降1维
lowDDataMat,reconDataMat = pca(dataMat,2)
print("原数据为：\n",dataMat)
print("降维之后的数据为\n",reconDataMat)

#降1维后的图表展示结果
plt.scatter(reconDataMat[:,0].tolist(),reconDataMat[:,1].tolist(), marker='o')
plt.scatter(dataMat[:,0].tolist(),dataMat[:,1].tolist(), marker='^')
plt.show()

plt.scatter(reconDataMat[:,0].tolist(),reconDataMat[:,2].tolist(), marker='o')
plt.scatter(dataMat[:,0].tolist(),dataMat[:,2].tolist(), marker='^')
plt.show()

plt.scatter(reconDataMat[:,1].tolist(),reconDataMat[:,2].tolist(), marker='o')
plt.scatter(dataMat[:,1].tolist(),dataMat[:,2].tolist(), marker='^')
plt.show()
```

    原数据为：
     [[149.5  69.5  38.5]
     [162.5  77.   55.5]
     [162.7  78.5  50.8]
     [162.2  87.5  65.5]
     [156.5  74.5  49. ]
     [156.1  74.5  45.5]
     [172.   76.5  51. ]
     [173.2  81.5  59.5]
     [159.5  74.5  43.5]
     [157.7  79.   53.5]]
    降维之后的数据为
     [[150.61501842  69.33245918  37.7256978 ]
     [163.23376412  78.83983947  53.83989659]
     [161.77310595  77.73933131  51.9746291 ]
     [169.60603725  83.64092077  61.97731994]
     [158.17370269  75.02742186  47.37817386]
     [156.65121871  73.88033208  45.43395451]
     [164.28952922  79.63528781  55.18811368]
     [169.23628168  83.3623347   61.5051403 ]
     [156.91572274  74.07961817  45.77172744]
     [161.40561923  77.46245466  51.50534679]]



![png](/Users/mankai/Downloads/PCA/output_0_1.png)


    原数据为：
     [[149.5  69.5  38.5]
     [162.5  77.   55.5]
     [162.7  78.5  50.8]
     [162.2  87.5  65.5]
     [156.5  74.5  49. ]
     [156.1  74.5  45.5]
     [172.   76.5  51. ]
     [173.2  81.5  59.5]
     [159.5  74.5  43.5]
     [157.7  79.   53.5]]
    降维之后的数据为
     [[149.5156614   69.77540728  38.32524549]
     [162.61871705  79.08765154  54.17531997]
     [162.63695088  77.39127471  51.50352079]
     [162.15135255  86.64452956  66.04282268]
     [156.56681018  75.67486392  48.25451219]
     [156.07789788  74.11133199  45.74662198]
     [172.00159099  76.52797778  50.98224722]
     [173.21474819  81.75934846  59.33543531]
     [159.41874439  73.07111169  44.40667421]
     [157.69752649  78.95650308  53.52760015]]



![png](/Users/mankai/Downloads/PCA/output_0_3.png)



![png](/Users/mankai/Downloads/PCA/output_0_4.png)



![png](/Users/mankai/Downloads/PCA/output_0_5.png)


